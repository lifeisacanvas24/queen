{# Intraday Card Template - 2-4 hour trades #}
{# Includes Technicals Box + F&O Sentiment #}

{% extends 'cards/card_base.html' %}

{% block card_content %}
    {# Signal Score #}
    {% include 'cards/partials/signal_score.html' %}
    
    {# R:R Box #}
    {% include 'cards/partials/rr_box.html' %}
    
    {# Technicals Box - Key for Intraday #}
    {% if signal.technicals %}
    <div class="info-box tech">
        <div class="box-title"><i class="fas fa-chart-area"></i>Technicals</div>
        <div class="grid-4">
            <div class="grid-item">
                <div class="grid-label">RSI</div>
                <div class="grid-value">{{ signal.technicals.rsi.value }}</div>
                <div class="grid-status {{ signal.technicals.rsi.status }}">{{ signal.technicals.rsi.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">MACD</div>
                <div class="grid-value">{{ signal.technicals.macd.value }}</div>
                <div class="grid-status {{ signal.technicals.macd.status }}">{{ signal.technicals.macd.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">EMA</div>
                <div class="grid-value">{{ signal.technicals.ema.value }}</div>
                <div class="grid-status {{ signal.technicals.ema.status }}">{{ signal.technicals.ema.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">ATR</div>
                <div class="grid-value">{{ signal.technicals.atr.value }}</div>
                <div class="grid-status {{ signal.technicals.atr.status }}">{{ signal.technicals.atr.label }}</div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {# F&O Sentiment Box - Key for Intraday #}
    {% if signal.fo_sentiment %}
    <div class="info-box fo">
        <div class="box-title"><i class="fas fa-layer-group"></i>F&O Sentiment</div>
        <div class="grid-4">
            <div class="grid-item">
                <div class="grid-label">PCR</div>
                <div class="grid-value">{{ signal.fo_sentiment.pcr.value }}</div>
                <div class="signal-badge {{ signal.fo_sentiment.pcr.signal }}">{{ signal.fo_sentiment.pcr.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">OI</div>
                <div class="grid-value">{{ signal.fo_sentiment.oi.value }}</div>
                <div class="signal-badge {{ signal.fo_sentiment.oi.signal }}">{{ signal.fo_sentiment.oi.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">Max Pain</div>
                <div class="grid-value">₹{{ signal.fo_sentiment.max_pain.value }}</div>
                <div class="signal-badge {{ signal.fo_sentiment.max_pain.signal }}">{{ signal.fo_sentiment.max_pain.label }}</div>
            </div>
            <div class="grid-item">
                <div class="grid-label">IV</div>
                <div class="grid-value">{{ signal.fo_sentiment.iv.value }}%</div>
                <div class="signal-badge {{ signal.fo_sentiment.iv.signal }}">{{ signal.fo_sentiment.iv.label }}</div>
            </div>
        </div>
    </div>
    {% endif %}
    
    {# Intraday Context #}
    {% if signal.context %}
    {% include 'cards/partials/context_box.html' %}
    {% endif %}
    
    {# FVG Zones (for breakouts) #}
    {% if signal.fvg_zones %}
    {% include 'cards/partials/fvg_zones.html' %}
    {% endif %}
    
    {# Trade Details with Exit Time #}
    <div class="trade-details">
        <div class="detail-row">
            <span class="detail-label">Entry</span>
            <span class="detail-value entry">₹{{ signal.entry_range }}</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Target</span>
            <span class="detail-value target">₹{{ signal.target }} ({{ signal.target_pct }})</span>
        </div>
        <div class="detail-row">
            <span class="detail-label">Stop Loss</span>
            <span class="detail-value stop">₹{{ signal.stop_loss }} ({{ signal.stop_pct }})</span>
        </div>
        <div class="detail-row">
            <span class="detail-label"><i class="fas fa-clock"></i> Exit Before</span>
            <span class="detail-value warning">{{ signal.exit_time | default('3:15 PM') }}</span>
        </div>
    </div>
    
    {# Confidence #}
    {% if signal.confidence %}
    {% include 'cards/partials/confidence.html' %}
    {% endif %}
{% endblock %}
