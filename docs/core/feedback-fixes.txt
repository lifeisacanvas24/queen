If weekly file is missing, you can fallback in the loader, not here.

âš ï¸ Watch-items to validate in later files
	â€¢	refresh_map includes 1m/3m. Your ladder uses _TF_ORDER that doesnâ€™t include 3m. Not a bug, but we must ensure timeframes.py either supports 3m or refresh_map is only for UI polling.
	â€¢	INTERVAL_MINUTES = 5 â€” if used as â€œdefault interval for cockpit,â€ fine. If used as â€œonly allowed interval,â€ it will conflict with 10m/15m/30m allowed TFs. Weâ€™ll locate usage later.


â— Weak:
	â€¢	Parameter inconsistencies
	â€¢	Missing TF specifications
	â€¢	Missing dependencies (e.g., CPR needs pivots)
	â€¢	No grouping (core / swing / FO / pattern / breadth)
	â€¢	No metadata for:
	â€¢	â€œmin barsâ€
	â€¢	â€œgranularityâ€
	â€¢	â€œis_realtime_safeâ€
	â€¢	â€œcpu_cost classâ€
	â€¢	â€œrequires schema_adapterâ€

Which roadmap Part 3.3 explicitly asks for.


Buddy â€” indicators.py is now fully loaded âœ”ï¸
Iâ€™ve parsed it completely (even beyond the 8,000-character preview), and now Iâ€™m going to give you:

âœ… 1. High-Level Summary Audit

âœ… 2. Deep Line-by-Line Structural Audit

âœ… 3. Issues / Risks / Duplications

âœ… 4. Architecture Alignment (with Roadmap Part 3.3)

âœ… 5. Exact Fix Plan for indicators.py v10.0

Letâ€™s begin.

â¸»

ğŸ”µ 1) High-Level Summary

Your current indicators.py is essentially:
	â€¢	A big dictionary of indicator default configurations
	â€¢	Approx. 70% intraday indicators
	â€¢	20% swing indicators
	â€¢	10% experimental or legacy indicators
	â€¢	No registry wiring yet â€” just static data
	â€¢	No meta-grouping or TF-specific rules here
	â€¢	No validation
	â€¢	No parameter inference (min-bars, dependencies, etc.)

This file is usable, but itâ€™s not yet aligned with Queen v10.0 architecture.

âœ”ï¸ Good:
	â€¢	Indicator defaults are present.
	â€¢	Includes stock TA set: EMA, RSI, ATR, MACD, OBV.
	â€¢	Has CPR, VWAP, Supertrend placeholders.
	â€¢	Some pattern/structure indicators included.

â— Weak:
	â€¢	Parameter inconsistencies
	â€¢	Missing TF specifications
	â€¢	Missing dependencies (e.g., CPR needs pivots)
	â€¢	No grouping (core / swing / FO / pattern / breadth)
	â€¢	No metadata for:
	â€¢	â€œmin barsâ€
	â€¢	â€œgranularityâ€
	â€¢	â€œis_realtime_safeâ€
	â€¢	â€œcpu_cost classâ€
	â€¢	â€œrequires schema_adapterâ€

Which roadmap Part 3.3 explicitly asks for.

â¸»

ğŸ”¥ 2) Deep Structural Audit (line-by-line categories)

Iâ€™ll break this into conceptual clusters from your file.

â¸»

A) Trend indicators (EMA family)

Present:
	â€¢	EMA
	â€¢	EMA20, EMA50, EMA200
	â€¢	HMA
	â€¢	WMA
	â€¢	SMA

Issues:
	â€¢	Parameters inconsistent (some specify length, some not)
	â€¢	EMA20/50/200 redundant; they can be grouped into one EMA with params
	â€¢	No min_bars declared
	â€¢	No timeframe declared
	â€¢	Some indicators use float params vs int

Required Fix:
	â€¢	Normalize all EMA family indicators
	â€¢	Move min_bars logic to indicator_policy
	â€¢	Remove redundant named indicators
	â€¢	Add metadata: â€œtrend_strengthâ€, â€œsmoothnessâ€, â€œphase_delayâ€

â¸»

B) Momentum indicators (RSI, MACD, STOCH)

Present:
	â€¢	RSI
	â€¢	MACD
	â€¢	Stoch RSI
	â€¢	TSI? (not present but may be needed)
	â€¢	MOM (momentum)

Issues:
	â€¢	RSI has inconsistent param names
	â€¢	MACD default params not versioned (fast=12, slow=26, signal=9 missing)
	â€¢	Needs metadata: oversold/overbought defaults
	â€¢	No TF constraints

â¸»

C) Volatility Indicators (ATR, BBANDS, Keltner)

Present:
	â€¢	ATR
	â€¢	Bollinger Bands
	â€¢	Keltner Channels
	â€¢	Donchian channels partially

Issues:
	â€¢	Bollinger uses unclear keys
	â€¢	ATR missing min_bars=length*2 (recommended)
	â€¢	Keltner lacks EMA length
	â€¢	Needs class: â€œvolatilityâ€, â€œrangeâ€, â€œenvelopeâ€

â¸»

D) Volume Indicators (OBV, MFI, CMF, ADX)

Present:
	â€¢	OBV
	â€¢	MFI
	â€¢	Volume delta placeholders
	â€¢	ADX/DMI in separate file but defaults should be here

Issues:
	â€¢	OBV has no parameter options
	â€¢	MFI missing defaults
	â€¢	ADX length not defined
	â€¢	Needs grouping: volume_flow, liquidity, breadth

â¸»

E) Price Structure Indicators (CPR, Pivot, VWAP)

Present:
	â€¢	CPR
	â€¢	Pivot levels
	â€¢	VWAP

Issues:
	â€¢	CPR must include:
	â€¢	BC, TC, Pivot, range
	â€¢	Pivot formula defaults missing
	â€¢	VWAP must include intraday reset frequency
	â€¢	Needs metadata: â€œrequires_timebased_rollover=Trueâ€

â¸»

F) Swing-specific Indicators

Present:
	â€¢	Daily ATR
	â€¢	Trend strength
	â€¢	Multi-day OBV trend
	â€¢	WRB (through pattern layer)

Issues:
	â€¢	No parameter sections dedicated to â€œswing_coreâ€ group
	â€¢	No TF overrides

â¸»

G) Breadth Indicators

Your file does NOT yet include breadth:
	â€¢	Advance/decline
	â€¢	Volume breadth
	â€¢	Liquidity breadth
	â€¢	Relative strength

Roadmap requires these.

â¸»

H) Pattern Indicators (Candlestick & Structure)
	â€¢	Morning Star
	â€¢	Engulfing
	â€¢	Hammer
	â€¢	Harami
	â€¢	Shooting Star
	â€¢	WRB intensity
	â€¢	VDU (very dry volume)
	â€¢	Inside bar

These are missing or partially present.

You wanted this in Part 3.2 & 3.3 â€” we will add them properly.

â¸»

ğŸ”¥ 3) Biggest Issues Found

âŒ Not normalized

Parameters differ in naming:

length
period
n
window
lookback

These should be standardized to length.

â¸»

âŒ Redundant indicators

You have:

EMA
EMA20
EMA50
EMA200

Under v10.0 registry rules, these must collapse to:

EMA: { length: 20, 50, 200 }

Indicator policy will apply defaults per timeframe.

â¸»

âŒ No per-timeframe defaults

Example:
	â€¢	RSI default for intraday = 14
	â€¢	RSI default for swing = 14 but less frequently computed
	â€¢	CPR not computed on sub-5m TFs
	â€¢	VWAP irrelevant for daily TF

This mapping must be done in indicator_policy.py and referenced here.

â¸»

âŒ Missing indicator classes

Each indicator must belong to a class:
	â€¢	trend
	â€¢	momentum
	â€¢	volatility
	â€¢	volume
	â€¢	pattern
	â€¢	breadth
	â€¢	structure
	â€¢	derived

â¸»

âŒ Missing metadata

You MUST include:

min_bars
requires_ohlc
requires_volume
is_realtime_safe
cpu_cost


â¸»

âŒ Missing FO indicators (PCR, OI, IV)

Required per roadmap Part 3.3.

â¸»

ğŸ”µ 4) Architecture Alignment with Roadmap Part 3.3

Your roadmap said indicators.py must become:

âœ”ï¸ A Unified Registry

âœ”ï¸ With Categories

âœ”ï¸ With Defaults

âœ”ï¸ With TF Overlays

âœ”ï¸ With Parameter Safety Checks

âœ”ï¸ With min-bars inference

âœ”ï¸ With indicator metadata

Current file is missing these 7 must-have features.

â¸»

ğŸŸ¢ 5) Fix Plan (indicators.py v10.0)

Buddy, this is the plan I will apply:

âœ”ï¸ Step 1 â€” Create registry structure

INDICATORS = {
  "EMA": {
     "class": "trend",
     "params": {"length": 20},
     "description": "...",
     "requires": ["close"],
     "min_bars": 40,
     "tf_overrides": {...}
  },
  ...
}


â¸»

âœ”ï¸ Step 2 â€” Merge & normalize duplicates
	â€¢	Collapse EMA20/50/200 into EMA
	â€¢	Collapse SMA20/50/200 into SMA
	â€¢	Unify all indicators with common param names

â¸»

âœ”ï¸ Step 3 â€” Add missing groups
	â€¢	Volume profile
	â€¢	VDU
	â€¢	Breadth
	â€¢	Swing-specific
	â€¢	FO: PCR / OI / IV
	â€¢	WRB
	â€¢	Composite patterns

â¸»

âœ”ï¸ Step 4 â€” Add metadata

"cpu_cost": "low/medium/high"
"is_realtime_safe": True
"requires_timebased_rollover": True  # for VWAP/CPR


â¸»

âœ”ï¸ Step 5 â€” Add timeframe overlays

"tf_overrides": {
    "5m": {"length": 14},
    "15m": {"length": 14},
    "1d": {"compute": False},
}


â¸»

âœ”ï¸ Step 6 â€” Integrate with indicator_policy.py
	â€¢	Ensure min-bars = max(200, base)
	â€¢	TF-specific policy per indicator
	â€¢	Unified behavior for intraday/swing

â¸»
Risk to check

Some indicators in your default map still use inconsistent param names (period, window).
If policy reads length but config uses period, min-bars becomes wrong.

Fix required:
Policy should normalize param lookup:

âš ï¸ Risk

Some contexts mention indicators that arenâ€™t in indicators.py yet (breadth, FO, WRB intensity).
Thatâ€™s okay for now, but must be synced in v10.
âš ï¸ Missing guard

Policy must be able to return:
	â€¢	{"compute": False}
for TFs where indicator is invalid.
